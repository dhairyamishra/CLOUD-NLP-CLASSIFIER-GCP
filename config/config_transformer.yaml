# Configuration for Transformer Model (DistilBERT)
# This is the LOCAL/TESTING configuration with minimal settings for fast iteration

# Model settings
model:
  name: "distilbert-base-uncased"
  num_labels: null  # Will be set automatically based on dataset
  max_seq_length: 128  # Standard length for most text classification tasks

# Training hyperparameters (LOCAL MODE - Fast Testing)
training:
  train_batch_size: 32  # Moderate batch size for local GPU/CPU
  eval_batch_size: 64   # Larger batch for evaluation
  learning_rate: 2.0e-5  # Standard DistilBERT learning rate
  num_train_epochs: 3    # Reasonable for local testing
  weight_decay: 0.01
  warmup_ratio: 0.1      # 10% warmup steps
  warmup_steps: 0        # Alternative to warmup_ratio (set to 0 to use ratio)
  gradient_accumulation_steps: 1
  max_grad_norm: 1.0
  
  # Optimization
  fp16: false  # Set to true if GPU supports mixed precision (NVIDIA with Tensor Cores)
  fp16_opt_level: "O1"  # Options: O0, O1, O2, O3 (O1 recommended)
  
  # DataLoader settings
  dataloader_num_workers: 0  # Set to 2-4 for faster data loading if CPU allows
  dataloader_pin_memory: true  # Speeds up CPU-to-GPU transfer
  
  # Early stopping
  early_stopping:
    enabled: true  # Enable for production training
    patience: 3    # Stop if no improvement for 3 evaluation cycles
    metric: "eval_f1_macro"  # Metric to monitor (eval_loss, eval_accuracy, eval_f1_macro, etc.)
    mode: "max"    # "max" for metrics to maximize, "min" for loss
  
  # Learning rate scheduler
  # Options: linear, cosine, cosine_with_restarts, polynomial, constant, constant_with_warmup
  lr_scheduler:
    type: "linear"  # Linear decay with warmup (recommended for transformers)
  
  # Logging and checkpointing
  logging_steps: 50      # Log every 50 steps
  eval_steps: 200        # Evaluate every 200 steps
  save_steps: 200        # Save checkpoint every 200 steps
  save_total_limit: 2    # Keep only 2 best checkpoints

# Data paths
data:
  train_path: "data/processed/train.csv"
  val_path: "data/processed/val.csv"
  test_path: "data/processed/test.csv"

# Model save paths
model_save_dir: "models/transformer/distilbert"

# Reproducibility
seed: 42

# Evaluation settings
evaluation:
  metrics:
    - "accuracy"
    - "f1_macro"
    - "f1_weighted"
    - "precision_macro"
    - "recall_macro"
  save_confusion_matrix: true
  save_classification_report: true
  compute_roc_auc: true  # For binary classification or OvR

# Device settings
device: "cuda"  # Options: "cuda", "cpu", "mps" (for Mac M1/M2)
